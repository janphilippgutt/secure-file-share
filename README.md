# Secure File Share

A serverless, security-focused file sharing backend that enables **authenticated users** to upload, list, download, and delete files in an S3 bucket via a secure API. 
It uses **AWS Cognito** for user authentication and **AWS Lambda + API Gateway** for backend operations.
For usability out of the box, a **lightweight HTML/JavaScript frontend** is included and deployed to Amazon CloudFront for fast, reliable delivery. 

A Live-Demo is available (see further down this README)

---

## Infrastructure Diagram

<img width="705" height="783" alt="Image" src="https://github.com/user-attachments/assets/0ece8184-a080-4178-a991-0145155311ca" />

## Features

- **User Authentication:** Uses AWS Cognito User Pool with JWT tokens to authenticate users.
- **Secure Upload & Download:** Files are uploaded and downloaded using time-limited, pre-signed URLs generated by a Lambda backend.
- **File Management:** Authenticated users can list and delete files in the S3 bucket.
- **Storage Limit:** Enforces a configurable maximum storage quota to avoid overuse.
- **CORS and Security Headers:** Proper CORS configuration to enable secure communication from the frontend.
- **Per-User File Isolation** (to prevent user A from listing/downloading user B’s files).
- **Minimal Frontend:** Lightweight HTML/JS example to demonstrate login and file operations.

---

## Security Highlights

- **JWT Authentication:** All API requests require a valid Cognito JWT token (access token) sent in the `Authorization` header.
- **Pre-signed URLs:** Upload and download URLs are short-lived and scoped to specific files, preventing unauthorized access.
- **Storage Quota Enforcement:** The backend checks total S3 usage before allowing new uploads, avoiding denial-of-service risks.
- **CORS Restrictions:** Only requests from authorized frontend origins are accepted, protecting against cross-site attacks.

---

## Use Case Example: Client File Portal

This project can serve as the backend of a secure Client File Portal for small agencies, consultancies, or service providers (e.g., design firms, legal advisors, or freelancers).

**In this scenario:**

- Clients log in using credentials managed via AWS Cognito.

- They can upload deliverables, view their document history, and download or delete files — all scoped securely to authenticated users.

- All file actions are handled via a secure API Gateway + Lambda architecture, with files stored in an S3 bucket.

- Access is restricted to authenticated sessions, ensuring unauthorized users cannot access any endpoints or data.

---

## Infrastructure as Code (IaC)

This project uses **modular Terraform** to provision and manage all AWS resources, including the S3 bucket, API Gateway, Lambda functions, Cognito User Pool, IAM roles, and CORS configurations. Modules are organized by resource type to keep the codebase clean and scalable. This approach supports reproducibility, version control, and easy extension for future improvements or environments. 
This modular infrastructure makes the backend easy to extend with role-based access control, audit logging, or integrations with external tools such as billing or notification systems.

For the Front-End deployment, this project calls moduls from a repository I maintain separately for reusable moduls:

```
module "s3_static_site" {
  source               = "git::https://github.com/janphilippgutt/terraform-aws-modules.git//modules/s3-static-site?ref=main"
  bucket_name          = "secure-file-share-static-site-demo${random_id.bucket_id}"
  environment          = "dev"
  enable_public_access = false
  use_oac              = true
  for_cloudfront       = true
}

module "cloudfront" {
  source             = "git::https://github.com/janphilippgutt/terraform-aws-modules.git//modules/cloudfront?ref=main"
  bucket_name        = module.s3_static_site.bucket_id
  bucket_arn         = module.s3_static_site.bucket_arn
  bucket_domain_name = module.s3_static_site.bucket_regional_domain_name
}
```

---

## Deployment

Please find a deployment guide in the separate DEPLOYMENT_GUIDE.md.  

## Live-Demo

Link to Loom Screencast:

<a href="https://www.loom.com/share/0a38a8e8e57447558f84c7c328c1dd7c?sid=4250666e-ae62-4659-b344-f9e427d16ff8">
    <img src="https://github.com/user-attachments/assets/6d17b7cb-9edd-42d3-9ae4-80862b7eb1cc" width="400" />
</a>

## Note

Always protect your AWS credentials and tokens.
In this project, no sensitive credentials are exposed in the frontend. 
However, in a more complex or production-grade application, consider using environment variables (.env) 
along with a build tool like Webpack or Vite to manage and inject non-sensitive config 
values securely—keeping sensitive data out of the client bundle and browser.

---

## License

MIT

---

Feel free to contribute or ask questions!

